(function(C,n,t,B){"use strict";var N=()=>cumcord.patcher.injectCSS(":root{--blur-effect: blur(1px);--blur-timing: 1s}.nsfw-text{background-color:#f04747;padding:0 6px;white-space:nowrap;text-overflow:ellipsis;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:8px;min-width:16px;min-height:16px;font-size:12px;line-height:16px;font-weight:600;color:#fff;text-align:center;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.nsfw-badge{position:relative;margin-left:4px;line-height:0}.blur .embedWrapper-1MtIDg img,.blur .embedWrapper-1MtIDg video{transition:var(--blur-timing)!important;filter:var(--blur-effect)!important}.blur .embedWrapper-1MtIDg img:hover,.blur .embedWrapper-1MtIDg video:hover{transition:var(--blur-timing)!important;filter:none!important}.blurnsfwsetting-textinput{display:flex}.blurnsfwsetting-textinput div{width:-webkit-fill-available}.blurnsfwsetting-textinput button{margin-left:9px}");const g=n.webpack.findByDisplayName("SwitchItem"),s=n.webpack.find(e=>e.DropdownSizes),p={dividerDefault:n.webpack.findByProps("dividerDefault").dividerDefault,divider:n.webpack.find(e=>e.divider?.includes("divider-_")).divider};var w=({className:e})=>t.React.createElement("div",{className:`${p.divider} ${p.dividerDefault} ${e}`});const D=n.webpack.findByDisplayName("Text"),T=n.webpack.findByDisplayName("ArrowDropDown"),$=n.webpack.findByDisplayName("ArrowDropUp"),r={...n.webpack.findByProps("wrapper","base"),...n.webpack.findByProps("flex"),...n.webpack.findByProps("size20"),...n.webpack.findByProps("marginBottom20"),...n.webpack.findByProps("dividerDefault")};var m=({opened:e,children:a,title:i,onChange:u})=>t.React.createElement("div",null,t.React.createElement("div",{onClick:()=>u?.(),className:[r.flex,r.alignCenter,r.marginBottom8].join(" ")},e?t.React.createElement($,{className:r.base,width:32,height:32}):t.React.createElement(T,{className:r.base,width:32,height:32}),t.React.createElement(D,{className:[r.base,r.size16,r.marginLeft8].join(" ")},i)),e?t.React.createElement("div",{className:[r.marginLeft8,r.marginBottom20].join(" ")},[...a]):null,!e&&t.React.createElement(w,{className:r.marginBottom20}));const I=n.webpack.findByDisplayName("FormItem"),S=n.webpack.findByDisplayName("FormText"),l={...n.webpack.findByProps("marginBottom20"),...n.webpack.findByProps("formText"),...n.webpack.findByDisplayName("Flex")};var v=e=>t.React.createElement(I,{title:e.title,required:e.required,className:`${l.Direction.VERTICAL} ${l.Justify.START} ${l.Align.STRETCH} ${l.Wrap.NO_WRAP} ${l.marginBottom20}`},e.children,e.note&&t.React.createElement(S,{className:`${l.description} ${l.marginTop8}`},e.note),t.React.createElement(w,{className:[l.marginTop20].join(" ")}));const A=n.webpack.findByDisplayName("Slider"),P={...n.webpack.findByProps("marginBottom20")};var k=e=>{const a=e.children;return delete e.children,t.React.createElement(v,{title:a,note:e.note,required:e.required},t.React.createElement(A,{...e,className:`${e.className} ${P.marginTop8}`}))};const E=n.webpack.findByDisplayName("TextInput");var R=e=>{Array.isArray(e.children)||(e.children=[e.children]);const a=e.children;return delete e.children,t.React.createElement(v,{title:a[0],required:e.required,note:e.note},a[1]?t.React.createElement("div",{className:"blurnsfwsetting-textinput"},t.React.createElement(E,{...e}),a[1]):t.React.createElement(E,{...e}))},F=({persist:e})=>{const[a,i]=t.React.useState(),[u,W]=t.React.useState();return B.useNest(e),t.React.createElement("div",null,t.React.createElement(g,{note:"Blur images/video in dms",value:e.ghost.dm,onChange:()=>e.store.dm=!e.ghost.dm},"Blur DMs"),t.React.createElement(g,{note:"Blur images/video in group chats",value:e.ghost.gc,onChange:()=>e.store.gc=!e.ghost.gc},"Blur Group chats"),t.React.createElement(g,{note:"Adds a more visible tags for nsfw channels",value:!e.ghost.notags,onChange:()=>e.store.notags=!e.ghost.notags},"NSFW Tags"),t.React.createElement(k,{stickToMarkers:!0,minValue:1,maxValue:75,initialValue:e.ghost.blur??10,markers:[5,10,15,20,25,30,35,40,45,50,65,60,70,75],onValueChange:c=>e.store.blur=c},"Blur effect"),t.React.createElement(k,{stickToMarkers:!0,minValue:.2,maxValue:10,initialValue:e.ghost.timing??1,markers:[.2,.5,1,2,3,4,5,6,7,8,9,10],onValueChange:c=>e.store.timing=c},"Blur Timing (in seconds)"),t.React.createElement(m,{opened:a,onChange:()=>i(!a),title:"Blocked channels (uneffected channels)"},e.ghost.blocked?.map((c,d)=>t.React.createElement(R,{placeholder:"Enter a channel/user id",value:c,onChange:o=>e.store.blocked[d]=o},"",t.React.createElement(s,{color:s.Colors.RED,onClick:()=>e.store.blocked=e.ghost.blocked.filter((o,f)=>f!==d)},"Remove"))),t.React.createElement(s,{onClick:()=>e.store.blocked=e.ghost.blocked?e.ghost.blocked.concat(""):[""]},"Add channel")),t.React.createElement(m,{opened:u,onChange:()=>W(!u),title:"Blur specific channels"},e.ghost.blurChannels?.map((c,d)=>t.React.createElement(R,{placeholder:"Enter a channel/user id",value:c,onChange:o=>e.store.blurChannels[d]=o},"",t.React.createElement(s,{color:s.Colors.RED,onClick:()=>e.store.blurChannels=e.ghost.blurChannels.filter((o,f)=>f!==d)},"Remove"))),t.React.createElement(s,{onClick:()=>e.store.blurChannels=e.ghost.blurChannels?e.ghost.blurChannels.concat(""):[""]},"Add channel")))};const y=[];let x;const L=n.webpack.findByDisplayName("ChannelItem",!1),{getChannel:V}=n.webpack.findByProps("getChannel","getDMFromUserId");function h({channelId:e}){const a=V(e);this.ghost.blocked?.includes(e)||this.ghost.blocked?.includes(a.recipients[0])||(a.nsfw||a.type===1&&this.ghost.dm||a.type===3&&this.ghost.gc||this.ghost.blurChannels?.includes(a.id)||this.ghost.blurChannels?.includes(a.recipients[0])?b():document.body.classList.remove("blur"))}var M=({persist:e})=>(h=h.bind(e),b=b.bind(e),{onLoad(){x=N(),y.push(C.after("default",L,([{channel:a}],i)=>{!a.nsfw||e.ghost.notags||i.props.children.props.children[1].props.children[1].props.children.push(t.React.createElement("div",{className:"nsfw-badge"},t.React.createElement("div",{className:"nsfw-text"},"NSFW")))})),t.FluxDispatcher.subscribe("CHANNEL_SELECT",h)},onUnload(){t.FluxDispatcher.unsubscribe("CHANNEL_SELECT",h),x?.(),y.forEach(a=>a())},settings:t.React.createElement(F,{persist:e})});function b(){const e=this.ghost.blur||10,a=this.ghost.timing||1,i=document.body;i.style.setProperty("--blur-effect",`blur(${e}px)`),i.style.setProperty("--blur-timing",`${a}s`),i.classList.add("blur")}return M})(cumcord.patcher,cumcord.modules,cumcord.modules.common,cumcord.utils);
