(function(u,n,h,T,t,$){"use strict";function I(e){if(e&&e.__esModule)return e;var s=Object.create(null);return e&&Object.keys(e).forEach(function(i){if(i!=="default"){var d=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(s,i,d.get?d:{enumerable:!0,get:function(){return e[i]}})}}),s.default=e,Object.freeze(s)}var r=I(T),S=()=>u.injectCSS(":root{--blur-effect: blur(1px);--blur-timing: 1s}.nsfw-text{background-color:#f04747;padding:0 6px;white-space:nowrap;text-overflow:ellipsis;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:8px;min-width:16px;min-height:16px;font-size:12px;line-height:16px;font-weight:600;color:#fff;text-align:center;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}.nsfw-badge{position:relative;margin-left:4px;line-height:0}.blur [class*=originalLink-]{z-index:0}.blur .embedWrapper-1MtIDg img,.blur .embedWrapper-1MtIDg video{transition:var(--blur-timing)!important;filter:var(--blur-effect)!important}.blur .embedWrapper-1MtIDg img:hover,.blur .embedWrapper-1MtIDg video:hover{transition:var(--blur-timing)!important;filter:none!important}.blurnsfwsetting-textinput{display:flex}.blurnsfwsetting-textinput div{width:-webkit-fill-available}.blurnsfwsetting-textinput button{margin-left:9px}");const f=n.webpack.findByDisplayName("SwitchItem"),l=n.webpack.find(e=>e.DropdownSizes),g={dividerDefault:n.webpack.findByProps("dividerDefault").dividerDefault,divider:n.webpack.find(e=>e.divider?.includes("divider-_")).divider};var w=({className:e})=>r.createElement("div",{className:`${g.divider} ${g.dividerDefault} ${e}`});const A=n.webpack.findByDisplayName("LegacyText"),P=n.webpack.findByDisplayName("ArrowDropDown"),j=n.webpack.findByDisplayName("ArrowDropUp"),c={...n.webpack.findByProps("wrapper","base"),...n.webpack.findByProps("flex"),...n.webpack.findByProps("size20"),...n.webpack.findByProps("marginBottom20"),...n.webpack.findByProps("dividerDefault")};var v=({opened:e,children:s,title:i,onChange:d})=>r.createElement("div",null,r.createElement("div",{onClick:()=>d?.(),className:[c.flex,c.alignCenter,c.marginBottom8].join(" ")},e?r.createElement(j,{className:c.base,width:32,height:32}):r.createElement(P,{className:c.base,width:32,height:32}),r.createElement(A,{className:[c.base,c.size16,c.marginLeft8].join(" ")},i)),e?r.createElement("div",{className:[c.marginLeft8,c.marginBottom20].join(" ")},[...s]):null,!e&&r.createElement(w,{className:c.marginBottom20}));const L=n.webpack.findByDisplayName("FormItem"),R=n.webpack.findByDisplayName("FormText"),a={...n.webpack.findByProps("marginBottom20"),...n.webpack.findByProps("formText"),...n.webpack.findByDisplayName("Flex")};var y=e=>r.createElement(L,{title:e.title,required:e.required,className:`${a.Direction.VERTICAL} ${a.Justify.START} ${a.Align.STRETCH} ${a.Wrap.NO_WRAP} ${a.marginBottom20}`},e.children,e.note&&r.createElement(R,{className:`${a.description} ${a.marginTop8}`},e.note),r.createElement(w,{className:[a.marginTop20].join(" ")}));const F=n.webpack.findByDisplayName("Slider"),_={...n.webpack.findByProps("marginBottom20")};var E=e=>{const s=e.children;return delete e.children,r.createElement(y,{title:s,note:e.note,required:e.required},r.createElement(F,{...e,className:`${e.className} ${_.marginTop8}`}))};const k=n.webpack.findByDisplayName("TextInput");var C=e=>{Array.isArray(e.children)||(e.children=[e.children]);const s=e.children;return delete e.children,r.createElement(y,{title:s[0],required:e.required,note:e.note},s[1]?r.createElement("div",{className:"blurnsfwsetting-textinput"},r.createElement(k,{...e}),s[1]):r.createElement(k,{...e}))},M=()=>{const[e,s]=r.useState(),[i,d]=r.useState();return $.useNest(t.persist),r.createElement("div",null,r.createElement(f,{note:"Blur images/video in dms",value:t.persist.ghost.dm,onChange:()=>t.persist.store.dm=!t.persist.ghost.dm},"Blur DMs"),r.createElement(f,{note:"Blur images/video in group chats",value:t.persist.ghost.gc,onChange:()=>t.persist.store.gc=!t.persist.ghost.gc},"Blur Group chats"),r.createElement(f,{note:"Adds a more visible tags for nsfw channels",value:!t.persist.ghost.notags,onChange:()=>t.persist.store.notags=!t.persist.ghost.notags},"NSFW Tags"),r.createElement(E,{stickToMarkers:!0,defaultValue:10,initialValue:t.persist.ghost.blur??10,markers:[5,10,15,20,25,30,35,40,45,50,55,65,60,70,75],onValueChange:o=>t.persist.store.blur=o},"Blur effect"),r.createElement(E,{stickToMarkers:!0,defaultValue:1,initialValue:t.persist.ghost.timing??1,markers:[.2,.5,1,2,3,4,5,6,7,8,9,10],onValueChange:o=>t.persist.store.timing=o},"Blur Timing (in seconds)"),r.createElement(v,{opened:e,onChange:()=>s(!e),title:"Blocked channels (uneffected channels)"},t.persist.ghost.blocked?.map((o,m)=>r.createElement(C,{placeholder:"Enter a channel/user id",value:o,onChange:b=>t.persist.store.blocked[m]=b},"",r.createElement(l,{color:l.Colors.RED,onClick:()=>t.persist.store.blocked=t.persist.ghost.blocked.filter((b,p)=>p!==m)},"Remove"))),r.createElement(l,{onClick:()=>t.persist.store.blocked=t.persist.ghost.blocked?t.persist.ghost.blocked.concat(""):[""]},"Add channel")),r.createElement(v,{opened:i,onChange:()=>d(!i),title:"Blur specific channels"},t.persist.ghost.blurChannels?.map((o,m)=>r.createElement(C,{placeholder:"Enter a channel/user id",value:o,onChange:b=>t.persist.store.blurChannels[m]=b},"",r.createElement(l,{color:l.Colors.RED,onClick:()=>t.persist.store.blurChannels=t.persist.ghost.blurChannels.filter((b,p)=>p!==m)},"Remove"))),r.createElement(l,{onClick:()=>t.persist.store.blurChannels=t.persist.ghost.blurChannels?t.persist.ghost.blurChannels.concat(""):[""]},"Add channel")))};const x=[];let B;const O=n.webpack.findByDisplayName("ChannelItem",!1),{getChannel:z}=n.webpack.findByProps("getChannel","getDMFromUserId");function N({channelId:e}){const s=z(e);!s||t.persist.ghost.blocked?.includes(e)||t.persist.ghost.blocked?.includes(s.recipients[0])||(s.nsfw||s.type===1&&t.persist.ghost.dm||s.type===3&&t.persist.ghost.gc||t.persist.ghost.blurChannels?.includes(s.id)||t.persist.ghost.blurChannels?.includes(s.recipients[0])?V():document.body.classList.remove("blur"))}var W={onLoad(){B=S(),x.push(u.after("default",O,([{channel:e}],s)=>{!e.nsfw||t.persist.ghost.notags||s.props.children.props.children[1].props.children[1].props.children.push(h.React.createElement("div",{className:"nsfw-badge"},h.React.createElement("div",{className:"nsfw-text"},"NSFW")))})),h.FluxDispatcher.subscribe("CHANNEL_SELECT",N)},onUnload(){h.FluxDispatcher.unsubscribe("CHANNEL_SELECT",N),B?.(),x.forEach(e=>e())},settings:M};function V(){const e=t.persist.ghost.blur||10,s=t.persist.ghost.timing||1,i=document.body;i.style.setProperty("--blur-effect",`blur(${e}px)`),i.style.setProperty("--blur-timing",`${s}s`),i.classList.add("blur")}return W})(cumcord.patcher,cumcord.modules,cumcord.modules.common,cumcord.modules.common.React,cumcord.pluginData,cumcord.utils);
