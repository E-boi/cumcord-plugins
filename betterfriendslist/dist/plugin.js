(function(u,C,d,O,i,v,E){"use strict";function A(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(o){if(o!=="default"){var s=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(r,o,s.get?s:{enumerable:!0,get:function(){return e[o]}})}}),r.default=e,Object.freeze(r)}var n=A(C),F=()=>u.injectCSS(".title{flex:none!important}.title>[class*=searchBar]{flex:10}.ccbfl-title{border-left:1px solid var(--background-modifier-accent);align-items:center;display:flex;padding:0 12px;margin:16px 20px 8px 30px;color:var(--header-secondary);-webkit-box-sizing:border-box;box-sizing:border-box;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-transform:uppercase;font-size:12px;line-height:16px;letter-spacing:.02em;font-family:var(--font-display);font-weight:500;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.ccbfl-title:hover{color:var(--interactive-hover)}.ccbfl-guilds{position:inherit;text-overflow:ellipsis;display:flex;margin-left:auto}.ccbfl-guilds [class*=icon-]{border-radius:12px;margin-left:-8px}.ccbfl-margin{margin-left:8px}");const[oe,se,L,k,{sortIcon:x,clickable:G,headerCell:T,headerCellContent:y}]=d.batchFind(({findByDisplayName:e,findByProps:r})=>{e("SectionTitle"),e("Flex"),e("ArrowDropDown"),e("ArrowDropUp"),r("headerCellSorted","sortIcon")});var j=({title:e,onClick:r,reversed:o,sort:s})=>{const[c,l]=n.useState(o),[a,p]=n.useState(s);return n.createElement("div",{onClick:()=>{a?c?(p(!1),l(!1)):l(!0):p(!0),r?.()},className:[G,T,y,"ccbfl-title"].join(" ")},e,a?c?n.createElement(k,{className:x}):n.createElement(L,{className:x}):null)};const[P,w]=d.batchFind(({findByDisplayName:e})=>{e("PeopleList",!1),e("Flex")}),I=[{key:"usernameLower",label:O.Messages.FRIENDS_COLUMN_NAME,sort:!1,reversed:!1},{key:"statusIndex",label:"Status",sort:!1,reversed:!1}],_={online:0,streaming:1,idle:2,dnd:3,offline:4,invisible:5,unknown:6};var $=()=>{const e=u.after("default",P,(r,o)=>(!Array.isArray(o.props.children)||i.persist.ghost.sort||(o.props.children.unshift(n.createElement(w,{align:w.Align.CENTER,className:"title"},o.props.children[1].props.children,I.map(s=>n.createElement(j,{title:s.label,sort:s.sort,reversed:s.reversed,onClick:()=>{s.sort?s.reversed?(s.sort=!1,s.reversed=!1):s.reversed=!s.reversed:s.sort=!0,o.props.children[0].props.children[2].props.onChange(o.props.children[0].props.children[2].props.query)}})),o.props.children[0])),o.props.children.splice(1,1),o.props.children.splice(1,1),!o.props.children[1]?.props.statusSections)||(o.props.children[1].props.statusSections=[].concat(o.props.children[1].props.statusSections).map(s=>{if(!s?.[0]?.key)return s;let c=[].concat(s);return c=c.map(l=>Object.assign({},l,{statusIndex:_[l.status]})),I.forEach(l=>{!l.sort||(c.sort((a,p)=>{let t=a[l.key],m=p[l.key];return t<m?-1:t>m?1:0}),l.reversed&&c.reverse())}),c})),o));return()=>{e()}};const[{NumberBadge:M},{badge:z},B]=d.batchFind(({findByProps:e,findByDisplayName:r})=>{e("NumberBadge"),e("badge","tabBar"),r("Tooltip")});var f=({count:e,tooltip:r})=>n.createElement(B,{text:r,position:"bottom"},o=>n.createElement("div",{...o},n.createElement(M,{count:e,className:z,style:{padding:"0px"}})));const{Messages:U}=v.i18n,{RelationshipTypes:h}=v.constants,[q,{getRelationships:K},{getStatus:V}]=d.batchFind(({findByDisplayName:e,findByProps:r})=>{e("TabBar"),r("getRelationships"),r("getStatus","isMobileOnline")});var H=()=>{const e=u.after("render",q.prototype,(r,o)=>{if(o.props["aria-label"]!==U.FRIENDS||i.persist.ghost.all)return o;const s=Object.entries(K()),c=s.map(t=>t[1]===h.FRIEND&&V(t[0])!=="offline"&&t).filter(t=>t).length,l=s.map(t=>t[1]===h.FRIEND&&t).filter(t=>t).length,a=[s.map(t=>t[1]===h.PENDING_INCOMING).filter(t=>t).length,s.map(t=>t[1]===h.PENDING_OUTGOING).filter(t=>t).length],p=s.map(t=>t[1]===h.BLOCKED).filter(t=>t).length;return o.props.children.forEach(t=>{const m=Array.isArray(t.props.children)?t.props.children[0]:t.props.children;switch(t.props.id){case"ONLINE":t.props.children=[m,n.createElement(f,{count:c})];break;case"ALL":t.props.children=[m,n.createElement(f,{count:l})];break;case"PENDING":t.props.children=[m,n.createElement(f,{count:a[0],tooltip:"Incoming"}),n.createElement(f,{count:a[1],tooltip:"Outgoing"})];break;case"BLOCKED":t.props.children=[m,n.createElement(f,{count:p})];break}}),o});return()=>{e()}};const[{GuildIcon:S},{TooltipContainer:J}]=d.batchFind(({findByDisplayName:e,findByProps:r})=>{r("GuildIcon"),e("Tooltip",!1)});var Q=({guilds:e})=>n.createElement("div",{className:"ccbfl-guilds"},e.map(r=>n.createElement(J,{text:r.name,position:"bottom"},n.createElement(S,{guild:r,size:S.Sizes.SMALLER,style:r.icon&&{backgroundImage:`url("https://cdn.discordapp.com/icons/${r.id}/${r.icon}.webp?size=256")`}}))));const N=[],[W,X,Y,Z]=d.batchFind(({findByDisplayName:e})=>{e("PeopleListItem"),e("FriendRow"),e("PendingRow",!1),e("BlockedRow",!1)});function D(e,r){if(i.persist.ghost.mutual||!this.props.mutualGuilds?.length)return r;const o=this.props.mutualGuilds,s=r.props.children;return r.props.children=(...c)=>{const l=s(...c),a=E.findInReactTree(l,p=>Array.isArray(p.children))?.children;return a&&(a.splice(1,0,n.createElement(Q,{guilds:o})),a[2].props.className+=" ccbfl-margin"),l},r}function b(e,r){return r.props.mutualGuilds=this?.props?.mutualGuilds||e[0].mutualGuilds,r}var ee=()=>(N.push(u.after("render",W.prototype,D),u.after("render",X.prototype,b),u.after("default",Y,b),u.after("default",Z,b)),()=>{N.forEach(e=>e?.())});const g=d.findByDisplayName("SwitchItem");var te=()=>(E.useNest(i.persist),n.createElement("div",null,n.createElement(g,{value:!i.persist.ghost.all,onChange:()=>i.persist.store.all=!i.persist.ghost.all},"Adds total Amount for All/Requested/Blocked"),n.createElement(g,{value:!i.persist.ghost.sort,onChange:()=>i.persist.store.sort=!i.persist.ghost.sort},"Adds Sort Options"),n.createElement(g,{value:!i.persist.ghost.mutual,onChange:()=>i.persist.store.mutual=!i.persist.ghost.mutual},"Adds mutual Servers in Friend List")));const R=[];var re={onLoad(){R.push(F(),$(),H(),ee())},onUnload(){R.forEach(e=>e?.())},settings:te};return re})(cumcord.patcher,cumcord.modules.common.React,cumcord.modules.webpack,cumcord.modules.common.i18n,cumcord.pluginData,cumcord.modules.common,cumcord.utils);
