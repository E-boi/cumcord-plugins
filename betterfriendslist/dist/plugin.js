(function(d,$,u,C,l,y,v){"use strict";function O(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(s){if(s!=="default"){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}}),r.default=e,Object.freeze(r)}var n=O($),w=()=>d.injectCSS(".title{flex:none!important}.title>[class*=searchBar]{flex:10}.ccbfl-title{border-left:1px solid var(--background-modifier-accent);align-items:center;display:flex;padding:0 12px;margin:16px 20px 8px 30px;color:var(--header-secondary);-webkit-box-sizing:border-box;box-sizing:border-box;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-transform:uppercase;font-size:12px;line-height:16px;letter-spacing:.02em;font-family:var(--font-display);font-weight:500;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.ccbfl-title:hover{color:var(--interactive-hover)}.ccbfl-guilds{position:inherit;text-overflow:ellipsis;display:flex;margin-left:auto}.ccbfl-guilds [class*=icon-]{border-radius:12px;margin-left:-8px}.ccbfl-margin{margin-left:8px}");const[se,oe,A,R,{sortIcon:E,clickable:F,headerCell:G,headerCellContent:k}]=u.batchFind(({findByDisplayName:e,findByProps:r})=>{e("SectionTitle"),e("Flex"),e("ArrowDropDown"),e("ArrowDropUp"),r("headerCellSorted","sortIcon")});var L=({title:e,onClick:r,reversed:s,sort:o})=>{const[a,i]=n.useState(s),[c,p]=n.useState(o);return n.createElement("div",{onClick:()=>{c?a?(p(!1),i(!1)):i(!0):p(!0),r?.()},className:[F,G,k,"ccbfl-title"].join(" ")},e,c?a?n.createElement(R,{className:E}):n.createElement(A,{className:E}):null)};const[P,N]=u.batchFind(({findByDisplayName:e})=>{e("PeopleList",!1),e("Flex")}),x=[{key:"usernameLower",label:C.Messages.FRIENDS_COLUMN_NAME,sort:!1,reversed:!1},{key:"statusIndex",label:"Status",sort:!1,reversed:!1}],j={online:0,streaming:1,idle:2,dnd:3,offline:4,invisible:5,unknown:6};var D=()=>{const e=d.after("default",P,(r,s)=>(!Array.isArray(s.props.children)||l.persist.ghost.sort||(s.props.children.unshift(n.createElement(N,{align:N.Align.CENTER,className:"title"},s.props.children[1].props.children,x.map(o=>n.createElement(L,{title:o.label,sort:o.sort,reversed:o.reversed,onClick:()=>{o.sort?o.reversed?(o.sort=!1,o.reversed=!1):o.reversed=!o.reversed:o.sort=!0,s.props.children[0].props.children[2].props.onChange(s.props.children[0].props.children[2].props.query)}})),s.props.children[0])),s.props.children.splice(1,1),s.props.children.splice(1,1),!s.props.children[1]?.props.statusSections)||(s.props.children[1].props.statusSections=[].concat(s.props.children[1].props.statusSections).map(o=>{if(!o?.[0]?.key)return o;let a=[].concat(o);return a=a.map(i=>Object.assign({},i,{statusIndex:j[i.status]})),x.forEach(i=>{!i.sort||(a.sort((c,p)=>{let t=c[i.key],m=p[i.key];return t<m?-1:t>m?1:0}),i.reversed&&a.reverse())}),a})),s));return()=>{e()}};const[{NumberBadge:T},{badge:_},M]=u.batchFind(({findByProps:e,findByDisplayName:r})=>{e("NumberBadge"),e("badge","tabBar"),r("Tooltip")});var f=({count:e,tooltip:r})=>n.createElement(M,{text:r,position:"bottom"},s=>n.createElement("div",{...s},n.createElement(T,{count:e,className:_,style:{padding:"0px"}})));const{Messages:z}=y.i18n,{RelationshipTypes:h}=y.constants,[U,{getRelationships:q},{getStatus:K}]=u.batchFind(({findByDisplayName:e,findByProps:r})=>{e("TabBar"),r("getRelationships"),r("getStatus","isMobileOnline")});var H=()=>{const e=d.after("render",U.prototype,(r,s)=>{if(s.props["aria-label"]!==z.FRIENDS||l.persist.ghost.all)return s;const o=Object.entries(q()),a=o.map(t=>t[1]===h.FRIEND&&K(t[0])!=="offline"&&t).filter(t=>t).length,i=o.map(t=>t[1]===h.FRIEND&&t).filter(t=>t).length,c=[o.map(t=>t[1]===h.PENDING_INCOMING).filter(t=>t).length,o.map(t=>t[1]===h.PENDING_OUTGOING).filter(t=>t).length],p=o.map(t=>t[1]===h.BLOCKED).filter(t=>t).length;return s.props.children.forEach(t=>{const m=Array.isArray(t.props.children)?t.props.children[0]:t.props.children;switch(t.props.id){case"ONLINE":t.props.children=[m,n.createElement(f,{count:a})];break;case"ALL":t.props.children=[m,n.createElement(f,{count:i})];break;case"PENDING":t.props.children=[m,n.createElement(f,{count:c[0],tooltip:"Incoming"}),n.createElement(f,{count:c[1],tooltip:"Outgoing"})];break;case"BLOCKED":t.props.children=[m,n.createElement(f,{count:p})];break}}),s});return()=>{e()}};const[{GuildIcon:I},{TooltipContainer:J}]=u.batchFind(({findByDisplayName:e,findByProps:r})=>{r("GuildIcon"),e("Tooltip",!1)});var Q=({guilds:e})=>n.createElement("div",{className:"ccbfl-guilds"},e.map(r=>n.createElement(J,{text:r.name,position:"bottom"},n.createElement(I,{guild:r,size:I.Sizes.SMALLER,style:r.icon&&{backgroundImage:`url("https://cdn.discordapp.com/icons/${r.id}/${r.icon}.webp?size=256")`}}))));const S=[],[V,W,X,Y]=u.batchFind(({findByDisplayName:e})=>{e("PeopleListItem"),e("FriendRow"),e("PendingRow",!1),e("BlockedRow",!1)});function Z(e,r){if(l.persist.ghost.mutual||!this.props.mutualGuilds?.length)return r;const s=this.props.mutualGuilds,o=r.props.children;return r.props.children=(...a)=>{const i=o(...a),c=v.findInReactTree(i,p=>Array.isArray(p.children))?.children;return c&&(c.splice(1,0,n.createElement(Q,{guilds:s})),c[2].props.className+=" ccbfl-margin"),i},r}function g(e,r){return r.props.mutualGuilds=this?.props?.mutualGuilds||e[0].mutualGuilds,r}var ee=()=>(S.push(d.after("render",V.prototype,Z),d.after("render",W.prototype,g),d.after("default",X,g),d.after("default",Y,g)),()=>{S.forEach(e=>e?.())});const b=u.findByDisplayName("SwitchItem");var te=()=>(v.useNest(l.persist),n.createElement("div",null,n.createElement(b,{value:!l.persist.ghost.all,onChange:()=>l.persist.store.all=!l.persist.ghost.all},"Adds total Amount for All/Requested/Blocked"),n.createElement(b,{value:!l.persist.ghost.sort,onChange:()=>l.persist.store.sort=!l.persist.ghost.sort},"Adds Sort Options"),n.createElement(b,{value:!l.persist.ghost.mutual,onChange:()=>l.persist.store.mutual=!l.persist.ghost.mutual},"Adds mutual Servers in Friend List")));const B=[];var re={onLoad(){B.push(w(),D(),H(),ee())},onUnload(){B.forEach(e=>e?.())},settings:te};return re})(cumcord.patcher,cumcord.modules.common.React,cumcord.modules.webpack,cumcord.modules.common.i18n,cumcord.pluginData,cumcord.modules.common,cumcord.utils);
