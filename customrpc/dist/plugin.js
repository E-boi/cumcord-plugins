(function(P,Z,p,J,r,K,l,g,Q){"use strict";function X(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach(function(s){if(s!=="default"){var a=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return e[s]}})}}),n.default=e,Object.freeze(n)}var t=X(Z);const D=l.findByDisplayName("TextInput"),z=l.findByDisplayName("SwitchItem"),w=l.findByDisplayName("Text")||l.findByDisplayName("LegacyText"),M=l.findByProps("Sizes","Tags"),ee=l.findByDisplayName("UserActivityContainer"),O=l.findByDisplayName("FormItem"),te=l.findByDisplayName("ArrowDropDown"),re=l.findByDisplayName("ArrowDropUp"),U=l.findByDisplayName("SelectTempWrapper"),E=l.find(e=>e.DropdownSizes),c=l.findByDisplayName("Flex"),{ScrollerThin:se}=l.findByProps("ScrollerThin"),ne=l.findByDisplayName("SlideIn"),ae=l.findByDisplayName("SettingsNotice"),oe=l.findByDisplayName("TransitionGroup"),B=l.findByProps("ModalRoot"),ie=l.findByProps("openModalLazy"),L=e=>ie.openModal(n=>(e.props={...e.props,...n},e)),le=p.webpack.findByProps("dividerDefault").dividerDefault,ce=p.webpack.findByDisplayName("FormDivider");var N=({className:e})=>t.createElement(ce,{className:[le,e].join(" ")});const S={...p.webpack.findByProps("marginBottom20")};var x=e=>{Array.isArray(e.children)||(e.children=[e.children]);const n=e.children[0];e.children.splice(0,1);const s=e.children.map(a=>a&&t.createElement(c.Child,{className:"crpc-lowerMargin",grow:0,shrink:0,wrap:!0},a));return delete e.children,t.createElement(O,{title:n,className:S.marginBottom20,required:e.required},s.length?t.createElement(c,null,t.createElement(c.Child,{grow:1,shrink:1,wrap:!0},t.createElement(U,{...e})),[...s]):t.createElement(U,{...e}),!e.noDivider&&t.createElement(N,{className:[S.marginTop20,S.marginBottom20].join(" ")}))};const A={...p.webpack.findByProps("marginBottom20")};var h=e=>{const n=e.children;return delete e.children,t.createElement(O,{title:n,required:e.required,className:A.marginBottom20},t.createElement(D,{...e}),!e.noDivider&&t.createElement(N,{className:[A.marginTop20,A.marginBottom20].join(" ")}))};const u={...p.webpack.findByProps("wrapper","base"),...p.webpack.findByProps("flex"),...p.webpack.findByProps("size20"),...p.webpack.findByProps("marginBottom20"),...p.webpack.findByProps("dividerDefault")};var R=({opened:e,children:n,title:s,onChange:a})=>(Array.isArray(n)||(n=[n]),t.createElement("div",null,t.createElement("div",{onClick:()=>a?.(),className:[u.flex,u.alignCenter,u.marginBottom8].join(" ")},e?t.createElement(re,{className:u.base,width:32,height:32}):t.createElement(te,{className:u.base,width:32,height:32}),t.createElement(w,{className:[u.base,u.size16,u.marginLeft8].join(" ")},s)),e?t.createElement("div",{className:[u.marginLeft8,u.marginBottom20].join(" ")},[...n]):null,!e&&t.createElement(N,{className:u.marginBottom20})));const k=l.findByProps("getActivities"),{useStateFromStores:me}=l.findByProps("useStateFromStores");var F=({user:e})=>{const n=me([k],()=>k.getActivities(e.id));return t.createElement(se,{className:"userProfileScroll-crpc"},n.map(s=>t.createElement(ee,{type:"Profile",activity:s,user:e,source:"Profile Modal",className:["userProfile-crpc","newProfileActivityStyles"].join(" ")},s.application_id," - ",s.session_id," - ",s.name)))};const{noticeRegion:pe}=l.findByProps("noticeRegion");var de=({onReset:e,onSave:n})=>t.createElement(oe,null,t.createElement(ne,{className:[pe,"crpc-notice"].join(" ")},t.createElement(ae,{onReset:e,onSave:n,theme:"dark"})));const{ActionTypes:ue}=P.constants,{getAssetIds:he,getAssets:ge}=l.findByProps("getAssetIds");function ye(){if(r.persist.ghost.converte)return;const e=r.persist.ghost.rpc1?Object.entries(r.persist.ghost):Object.entries(r.persist.ghost.rpcs),n=e.map(a=>{if(typeof a[1]!="object")return;const d=a[1];return d.buttons=[],d.buttons.push(d.button1||b.buttons[0]),d.buttons.push(d.button2||b.buttons[1]),d}).filter(a=>a),s=typeof r.persist.ghost.selected!="number"?e.findIndex(a=>a[0]===r.persist.ghost.selected):r.persist.ghost.selected;r.persist.store.rpc1=null,r.persist.store.rpc2=null,r.persist.store.rpc3=null,r.persist.store.rpcs=n,r.persist.store.selected=s,r.persist.store.disabled=r.persist.ghost.disable,r.persist.store.converte=!0}async function v(e){const n=e&&await fe(e);P.FluxDispatcher.dispatch({type:ue.LOCAL_ACTIVITY_UPDATE,socketId:"cumcord-epic-sex",pid:69,activity:n})}async function fe(e){const n=await he(e.client_id,[e.large_image,e.small_image]),s={application_id:e.client_id,name:e.name,details:e.details,state:e.type!==1?e.state:null,assets:{large_image:e.type!==1?n[0]:null,small_image:e.type!==1?n[1]:null,large_text:e.type!==1?e.large_text:null,small_text:e.type!==1?e.small_text:null},timestamps:e.show_time&&{start:Date.now()},party:e.party&&e.party_size&&{size:[e.party,e.party_size],id:"cum"},type:e.type,url:e.url};return e.buttons?.forEach(a=>{a?.url&&a?.label&&(s.buttons||(s.buttons=[]),s.metadata||(s.metadata={button_urls:[]}),s.buttons.push(a.label),s.metadata.button_urls.push(a.url))}),s}async function Ee(e){const n=await ge(e),s=Object.values(n).filter(a=>a.type===1);return s.unshift({name:"",type:1}),s.filter(a=>a.type===1).map(a=>({label:a.name,value:a.name}))}const b={show_time:!0,client_id:"892203377503658064",name:"cum",state:"eating cum",details:"Browsing cum",large_image:"cumcord",small_image:"cumcord",large_text:"cuming",small_text:"made with cum",buttons:[{label:"",url:""},{label:"",url:""}],type:0},{getCurrentUser:ve}=l.findByProps("getCurrentUser"),I={...l.findByProps("h5"),...l.findByProps("marginBottom20")},f=({children:e,grow:n,shrink:s,wrap:a})=>(Array.isArray(e)||(e=[e]),e.map(d=>t.createElement(c.Child,{wrap:a,grow:n||1,shrink:s||1},d)));var q=({rpcName:e,transitionState:n,onClose:s})=>{const[a,d]=g.useState(),[G,j]=g.useState(),[H,$]=g.useState(),[_e,V]=g.useState(),[C,Ne]=g.useState(),[o,Se]=g.useState(Object.assign({},r.persist.ghost.rpcs[e]));g.useEffect(()=>{o.buttons=o.buttons.map(i=>({label:i.label,url:i.url}))});const m=i=>{const y=i||o;Se(Object.assign({},y)),_.isEqual(Object.assign({},r.persist.ghost.rpcs[e]),y)?V(!1):V(!0)};return C||Ee(o.client_id).then(i=>Ne(i)).catch(()=>{}),t.createElement(B.ModalRoot,{className:"crpc-edit",transitionState:n},t.createElement(B.ModalHeader,{separator:!1},t.createElement(f,null,t.createElement(M,{size:M.Sizes.SIZE_20,tag:"h2"},"Edit RPC"),t.createElement(B.ModalCloseButton,{onClick:s}))),t.createElement(B.ModalContent,null,t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(c.Child,{wrap:!0},t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(f,{wrap:!0,grow:0,shrink:0},t.createElement(h,{required:!0,noDivider:!0,value:o.client_id,onChange:i=>{o.client_id=i,m()}},"Client id"),t.createElement(h,{noDivider:!0,value:o.name,onChange:i=>{o.name=i,m()}},"Name"),t.createElement(h,{noDivider:!0,value:o.details,onChange:i=>{o.details=i,m()}},"Details"),t.createElement(h,{noDivider:!0,value:o.state,onChange:i=>{o.state=i,m()}},"State")),t.createElement(c.Child,null,t.createElement(z,{value:o.show_time,onChange:()=>{o.show_time=!o.show_time,m()}},"Show Time"),t.createElement(R,{title:"Images",opened:G,onChange:()=>!j(!G)&&!$(!1)&&d(!1)},t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(f,{wrap:!0,grow:1,shrink:1},C&&t.createElement(x,{value:o.large_image,options:C,onChange:i=>{o.large_image=i.value,m()}},"Large Image"),t.createElement(h,{value:o.large_text,onChange:i=>{o.large_text=i,m()}},"Large Image Text"))),t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(f,{wrap:!0,grow:1,shrink:1},C&&t.createElement(x,{value:o.small_image,options:C,onChange:i=>{o.small_image=i.value,m()}},"Small Image"),t.createElement(h,{value:o.small_text,onChange:i=>{o.small_text=i,m()}},"Small Image Text")))),t.createElement(R,{title:"Buttons",opened:a,onChange:()=>!d(!a)&&!j(!1)&&$(!1)},o.buttons.map((i,y)=>t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(f,{wrap:!0,grow:1,shrink:1},t.createElement(h,{value:i.url,placeholder:"https://",onChange:W=>{o.buttons[y].url=W,m()}},"Button ",y+1," URL"),t.createElement(h,{value:i.label,onChange:W=>{o.buttons[y].label=W,m()}},"Button ",y+1," Text"))))),t.createElement(R,{title:"Party",opened:H,onChange:()=>!$(!H)&&!d(!1)&&j(!1)},t.createElement(c,{wrap:c.Wrap.WRAP},t.createElement(f,{wrap:!0,grow:1,shrink:1},t.createElement(h,{value:o.party,onChange:i=>{try{o.party=i?parseInt(i):void 0,m()}catch{}}},"Members in party"),t.createElement(h,{value:o.party_size,onChange:i=>{try{o.party_size=i?parseInt(i):void 0,m()}catch{}}},"Size of the party")))),t.createElement(w,{className:`${I.h5} ${I.marginBottom8}`},"Your RPC:"),t.createElement("div",{className:I.marginBottom20,style:{backgroundColor:"var(--background-floating)"}},t.createElement(F,{user:ve()})))))),_e&&t.createElement(de,{onReset:()=>{m(r.persist.ghost.rpcs[e])},onSave:()=>{r.persist.store.rpcs[e]=o,m(),r.persist.ghost.selected===e&&v(o)}})))};const{getCurrentUser:Ce}=p.webpack.findByProps("getCurrentUser"),T={...p.webpack.findByProps("h5"),...p.webpack.findByProps("marginBottom20")};var Be=()=>{J.useNest(r.persist);const[e,n]=g.useState(r.persist.ghost.selected);return t.createElement("div",null,t.createElement(z,{value:r.persist.ghost.disabled,onChange:()=>{r.persist.store.disabled=!r.persist.ghost.disabled,v(r.persist.ghost.disabled?null:r.persist.ghost.rpcs[e])}},"Disabled"),t.createElement(x,{value:e,onChange:s=>n(s.value),options:r.persist.ghost.rpcs.map((s,a)=>({label:s.name,value:a}))},"RPC'S",!isNaN(e)&&r.persist.ghost.selected!==e&&t.createElement(E,{disabled:r.persist.ghost.selected===e,onClick:()=>{r.persist.store.selected=e,r.persist.ghost.disabled||v(r.persist.ghost.rpcs[e])}},"Set as RPC"),e!==null&&t.createElement(E,{onClick:()=>L(t.createElement(q,{rpcName:e}))},"Edit RPC"),t.createElement(E,{onClick:()=>{r.persist.store.rpcs.push(b),n(r.persist.ghost.rpcs.length-1),L(t.createElement(q,{rpcName:r.persist.ghost.rpcs.length-1}))}},"Create new RPC"),t.createElement(E,{color:E.Colors.RED,onClick:()=>K.showConfirmationModal({confirmText:"Delete",content:"Are you sure you want to delete that rpc?",type:"danger"},s=>{!s||(r.persist.store.rpcs.splice(e,1),r.persist.store.selected=null,n(null))})},"Delete RPC")),t.createElement(w,{className:`${T.h5} ${T.marginBottom8}`},"Your RPC:"),t.createElement("div",{className:T.marginBottom20,style:{backgroundColor:"var(--background-floating)"}},t.createElement(F,{user:Ce()})))},be=()=>Q.injectCSS(".rpcsetting-select{display:flex}.rpcsetting-select .select-1YfRS9{width:-webkit-fill-available}.rpcsetting-select button{margin-left:9px}.userProfileScroll-crpc{padding:8px 0;height:100%}.userProfile-crpc{position:relative;padding:16px}.crpc-edit{width:800px}.crpc-notice{position:fixed}.crpc-lowerMargin{margin-left:5px;margin-right:5px}");let Y;function Pe(){r.persist.store.rpcs=[],r.persist.store.rpcs.push(b),r.persist.store.selected=0}var we=()=>(!r.persist.ghost.converte&&(r.persist.ghost.rpc1||r.persist.ghost.rpcs)?ye():r.persist.ghost.rpcs||Pe(),{onLoad(){Y=be(),v(r.persist.ghost.rpcs[r.persist.ghost.selected])},onUnload(){Y?.(),v(null)},settings:P.React.createElement(Be)});return we})(cumcord.modules.common,cumcord.modules.common.React,cumcord.modules,cumcord.utils,cumcord.pluginData,cumcord.ui.modals,cumcord.modules.webpack,cumcord.modules.common.React,cumcord.patcher);
