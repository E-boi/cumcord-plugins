(function(c,d,T,B,P,m){"use strict";function E(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(o){if(o!=="default"){var n=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(e,o,n.get?n:{enumerable:!0,get:function(){return t[o]}})}}),e.default=t,Object.freeze(e)}var r=E(P);const{getActiveSocketAndDevice:$}=c.findByProps("getActiveSocketAndDevice"),i="https://api.spotify.com/v1/me/player",a=()=>$()?.socket?.accessToken,f=({title:t,uri:e},o)=>{if(!!a())return fetch(`${i}/queue?uri=${e}`,{headers:{authorization:`Bearer ${a()}`},method:"POST"}).then(n=>n.ok&&o&&m.showToast({title:`Queued: ${t}`}))};function x({title:t,uri:e},o){const n=a();!n||(o?f({uri:e}).then(()=>fetch(`${i}/next`,{headers:{authorization:`Bearer ${n}`},method:"POST"})).then(s=>s.ok&&m.showToast({title:`Now playing: ${t}`,duration:3e3})):fetch(`${i}/play`,{headers:{authorization:`Bearer ${n}`},method:"PUT",body:JSON.stringify({context_uri:e})}))}const{Button:p}=c.findByDisplayName("MiniPopover",!1),{TooltipContainer:h}=c.findByProps("TooltipContainer"),O=({uri:t,title:e,isTrack:o})=>r.createElement(h,{text:"Play On Spotify",position:"top"},r.createElement(p,{onClick:()=>x({uri:t,title:e},o)},r.createElement("svg",{viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg",style:{height:"20px"}},r.createElement("path",{d:"M7.712 22.04a.732.732 0 0 1-.806.007.767.767 0 0 1-.406-.703V4.656c0-.31.135-.544.406-.703.271-.16.54-.157.806.006l14.458 8.332c.266.163.4.4.4.709 0 .31-.134.546-.4.71L7.712 22.04z",fill:"currentColor","fill-rule":"evenodd"})))),k=({uri:t,title:e})=>r.createElement(h,{text:"Add to Queue",position:"top"},r.createElement(p,{onClick:()=>f({uri:t,title:e},!0)},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:20,width:20,viewBox:"8 6 36 36"},r.createElement("path",{fill:"currentColor",d:"M30 12H6v4h24v-4zm0 8H6v4h24v-4zM6 32h16v-4H6v4zm28-20v16.37c-.63-.23-1.29-.37-2-.37-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6V16h6v-4H34z"}))));let v;const z=c.findByDisplayName("MiniPopover",!1);var b={onLoad(){v=T.after("default",z,(t,e)=>{const o=B.findInReactTree(e,l=>l?.message)?.message;if(!o)return e;const n=o.embeds.find(l=>l.provider?.name==="Spotify");if(!n)return e;const{url:s,rawTitle:y}=n,[,,u,g]=s.match(/(https?:\/\/)?open.spotify.com\/(album|track|playlist)\/([^?]+)/)??[];if(!u||!g)return e;const w=`spotify:${u}:${g}`;return e.props.children.unshift(d.React.createElement(O,{uri:w,title:y,isTrack:u==="track"}),d.React.createElement(k,{uri:w,title:y})),e})},onUnload(){v?.()}};return b})(cumcord.modules.webpack,cumcord.modules.common,cumcord.patcher,cumcord.utils,cumcord.modules.common.React,cumcord.ui.toasts);
